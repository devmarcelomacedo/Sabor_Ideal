<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sabor Ideal - Gourmet</title>
    <link rel="icon" type="image/png" href="img/favicon.png">
    <link rel="apple-touch-icon" href="img/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #c0392b;
            --dark: #2c3e50;
            --light: #f4f7f6;
            --white: #ffffff;
            --green: #25d366;
        }

        * {
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: var(--light);
            color: var(--dark);
            margin: 0;
            padding-bottom: 50px;
        }

        header {
            background: var(--dark);
            color: var(--white);
            padding: 15px;
            text-align: center;
            border-bottom: 4px solid var(--primary);
        }

        .progress-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 12px;
            background: #fff;
            border-bottom: 1px solid #eee;
        }

        .step {
            font-size: 10px;
            color: #bbb;
            font-weight: 700;
            text-transform: uppercase;
        }

        .step.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }

        .screen {
            max-width: 600px;
            margin: 0 auto;
            padding: 15px;
        }

        .hidden {
            display: none !important;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .product-card {
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            cursor: pointer;
            border: 1px solid #eee;
        }

        .product-img {
            width: 100%;
            height: 120px;
            background-size: cover;
            background-position: center;
        }

        .product-info {
            padding: 10px;
        }

        .product-info h4 {
            margin: 0;
            font-size: 13px;
        }

        .product-info strong {
            color: var(--primary);
            font-size: 14px;
            display: block;
            margin-top: 5px;
        }

        #modal-qty {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: flex-end;
            z-index: 9999;
        }

        .modal-body {
            background: white;
            width: 100%;
            max-width: 500px;
            border-radius: 20px 20px 0 0;
            padding: 20px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .options-group {
            background: #fff;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #eee;
            margin-bottom: 12px;
        }

        .options-group strong {
            display: block;
            margin-bottom: 8px;
            font-size: 12px;
            color: var(--primary);
            text-transform: uppercase;
            border-left: 3px solid var(--primary);
            padding-left: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f5f5f5;
            font-size: 14px;
            cursor: pointer;
        }

        .checkbox-item input {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: var(--primary);
        }

        .btn {
            padding: 15px;
            border-radius: 10px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            text-transform: uppercase;
        }

        .btn-main {
            background: var(--primary);
            color: white;
        }

        .btn-whatsapp {
            background: var(--green);
            color: white;
        }

        textarea,
        input,
        select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #ddd;
            margin-top: 5px;
        }

        .resumo-item {
            background: #fff;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 5px solid var(--primary);
            position: relative;
        }

        .btn-remove {
            position: absolute;
            top: 12px;
            right: 12px;
            background: none;
            border: none;
            color: #ff4d4d;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <header>
        <h1 style="margin:0; font-size: 18px;">SABOR IDEAL GOURMET</h1>
        <small style="color: var(--green); font-weight: 600;">(22) 98830-2170</small>
    </header>

    <nav class="progress-bar">
        <div id="step-1" class="step active">In√≠cio</div>
        <div id="step-2" class="step">Escolha</div>
        <div id="step-3" class="step">Pedido</div>
    </nav>

    <section id="tela-inicio" class="screen">
        <div class="menu-grid">
            <div class="product-card" onclick="irPara('tela-lanches')">
                <div class="product-img"
                    style="background-image: url('https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400')">
                </div>
                <div class="product-info">
                    <h4>Self-Service e Marmitas</h4>
                </div>
            </div>
            <div class="product-card" onclick="irPara('tela-lanches')">
                <div class="product-img"
                    style="background-image: url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=400')">
                </div>
                <div class="product-info">
                    <h4>Lanches e Bebidas</h4>
                </div>
            </div>
        </div>
    </section>

    <section id="tela-lanches" class="screen hidden">
        <button class="btn" style="background:#ddd; margin-bottom:15px; padding: 10px; font-size: 11px;"
            onclick="irPara('tela-inicio')">‚Üê CATEGORIAS</button>
        <div id="grid-produtos" class="menu-grid"></div>
        <button class="btn btn-main" style="position: sticky; bottom: 10px;" onclick="irPara('tela-carrinho')"
            id="btn-resumo">VER CARRINHO (0)</button>
    </section>

    <section id="tela-carrinho" class="screen hidden">
        <h3>Meu Pedido</h3>
        <div id="lista-carrinho"></div>

        <div style="background: #fff; padding: 15px; border-radius: 12px; margin-top: 15px;">
            <strong>DADOS PARA ENTREGA:</strong>
            <input type="text" id="cliente-nome" placeholder="Seu nome completo">
            <input type="text" id="cliente-local" placeholder="Endere√ßo (Rua, N√∫mero, Bairro)">
            <select id="pagamento">
                <option value="Pix">Pix</option>
                <option value="Cart√£o">Cart√£o</option>
                <option value="Dinheiro">Dinheiro</option>
            </select>
        </div>

        <div style="text-align: right; padding: 20px 0;">
            <h2 id="total-valor" style="color: var(--primary); margin:0;">Total: R$ 0,00</h2>
        </div>
        <button class="btn btn-whatsapp" onclick="enviarWhatsApp()">üöÄ ENVIAR PEDIDO NO WHATSAPP</button>
        <button class="btn" style="background:none; color: #999; font-size: 12px;"
            onclick="irPara('tela-lanches')">ADICIONAR MAIS ITENS</button>
    </section>

    <div id="modal-qty" class="hidden">
        <div class="modal-body">
            <h2 id="modal-nome" style="margin-top:0; font-size: 18px;">Item</h2>
            <div id="area-customizacao"></div>
            <div id="controle-qtd" class="options-group">
                <strong>QUANTIDADE:</strong>
                <div style="display:flex; justify-content:center; gap:25px; align-items:center;">
                    <button onclick="alterarQtd(-1)"
                        style="width:40px;height:40px;border-radius:50%; border:1px solid #ddd;">-</button>
                    <span id="qtd-display" style="font-weight:bold; font-size: 20px;">1</span>
                    <button onclick="alterarQtd(1)"
                        style="width:40px;height:40px;border-radius:50%; border:1px solid #ddd;">+</button>
                </div>
            </div>
            <div id="controle-peso" class="options-group hidden">
                <strong>Peso (Kg):</strong>
                <input type="number" id="input-peso" step="0.01" oninput="calcularPrecoPeso()">
                <div id="label-preco-peso"
                    style="text-align: center; font-size: 18px; color: var(--primary); font-weight: bold; margin-top: 10px;">
                    R$ 0,00</div>
            </div>
            <textarea id="modal-obs" placeholder="Alguma observa√ß√£o? Ex: Sem cebola..."></textarea>
            <button class="btn btn-main" onclick="confirmarNoCarrinho()">ADICIONAR AO CARRINHO</button>
            <button class="btn" style="background:none; color: #999;" onclick="fecharModal()">CANCELAR</button>
        </div>
    </div>

    <script>
        const produtos = [
            { id: 1, nome: "Marmita Gourmet", precoBase: 20.00, tipo: "marmita", img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400" },
            { id: 7, nome: "Self-Service (Kg)", preco: 49.99, tipo: "peso", img: "https://images.unsplash.com/photo-1543339308-43e59d6b73a6?w=400" },
            { id: 2, nome: "X-Burger Especial", preco: 22.00, tipo: "unidade", img: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400" },
            { id: 5, nome: "Coca-Cola Lata", preco: 7.50, tipo: "unidade", img: "https://images.unsplash.com/photo-1554866585-cd94860890b7?w=400" }
        ];

        let carrinho = [];
        let itemAtual = null;
        let qtdAtual = 1;
        let precoCalculadoPeso = 0;

        window.onload = () => {
            const grid = document.getElementById('grid-produtos');
            produtos.forEach(p => {
                grid.innerHTML += `<div class="product-card" onclick="abrirModal(${p.id})">
                    <div class="product-img" style="background-image: url('${p.img}')"></div>
                    <div class="product-info"><h4>${p.nome}</h4><strong>${p.precoBase ? 'A partir de R$ ' + p.precoBase.toFixed(2) : 'R$ ' + p.preco.toFixed(2)}</strong></div>
                </div>`;
            });
        };

        function abrirModal(id) {
            itemAtual = produtos.find(p => p.id === id);
            qtdAtual = 1;
            document.getElementById('modal-nome').innerText = itemAtual.nome;
            document.getElementById('qtd-display').innerText = qtdAtual;
            document.getElementById('modal-obs').value = "";
            const area = document.getElementById('area-customizacao');
            const ctrlQtd = document.getElementById('controle-qtd');
            const ctrlPeso = document.getElementById('controle-peso');

            area.innerHTML = ""; ctrlQtd.classList.remove('hidden'); ctrlPeso.classList.add('hidden');

            if (itemAtual.tipo === "peso") {
                ctrlQtd.classList.add('hidden'); ctrlPeso.classList.remove('hidden');
                document.getElementById('input-peso').value = ""; document.getElementById('label-preco-peso').innerText = "R$ 0,00";
            } else if (itemAtual.tipo === "marmita") {
                area.innerHTML = `
                <div class="options-group"><strong>1. TAMANHO:</strong>
                    <label class="checkbox-item"><input type="radio" name="tam" value="P" data-preco="20.00" checked> Marmita P - R$ 20,00</label>
                    <label class="checkbox-item"><input type="radio" name="tam" value="M" data-preco="24.00"> Marmita M - R$ 24,00</label>
                    <label class="checkbox-item"><input type="radio" name="tam" value="G" data-preco="28.00"> Marmita G - R$ 28,00</label>
                </div>
                <div class="options-group"><strong>2. BASE:</strong>
                    <label class="checkbox-item"><input type="checkbox" name="base" value="Arroz"> Arroz</label>
                    <label class="checkbox-item"><input type="checkbox" name="base" value="Feij√£o"> Feij√£o</label>
                    <label class="checkbox-item"><input type="checkbox" name="base" value="Macarr√£o"> Macarr√£o</label>
                </div>
                <div class="options-group"><strong>3. PROTE√çNA:</strong>
                    <label class="checkbox-item"><input type="checkbox" name="prot" value="Peixe Grelhado"> Peixe Grelhado</label>
                    <label class="checkbox-item"><input type="checkbox" name="prot" value="Bolonhesa"> Bolonhesa</label>
                    <label class="checkbox-item"><input type="checkbox" name="prot" value="Frango Grelhado"> Frango Grelhado</label>
                </div>
                <div class="options-group"><strong>4. ACOMPANHAMENTOS/SALADA:</strong>
                    <label class="checkbox-item"><input type="checkbox" name="acomp" value="Feij√£o Tropeiro"> Feij√£o Tropeiro</label>
                    <label class="checkbox-item"><input type="checkbox" name="acomp" value="Farofa"> Farofa</label>
                    <label class="checkbox-item"><input type="checkbox" name="acomp" value="Salada"> Salada</label>
                    <label class="checkbox-item"><input type="checkbox" name="acomp" value="Pur√™"> Pur√™ de Batata</label>
                </div>`;
            }
            document.getElementById('modal-qty').classList.remove('hidden');
        }

        function calcularPrecoPeso() {
            const peso = parseFloat(document.getElementById('input-peso').value) || 0;
            precoCalculadoPeso = peso * itemAtual.preco;
            document.getElementById('label-preco-peso').innerText = `R$ ${precoCalculadoPeso.toFixed(2)}`;
        }

        function confirmarNoCarrinho() {
            let precoFinal = itemAtual.preco || 0;
            let detalhes = "";

            if (itemAtual.tipo === "peso") {
                const peso = document.getElementById('input-peso').value;
                if (!peso || peso <= 0) return alert("Informe o peso!");
                qtdAtual = parseFloat(peso); detalhes = `Peso: ${peso}kg`;
            } else if (itemAtual.tipo === "marmita") {
                const tam = document.querySelector('input[name="tam"]:checked');
                const bases = Array.from(document.querySelectorAll('input[name="base"]:checked')).map(e => e.value);
                const prots = Array.from(document.querySelectorAll('input[name="prot"]:checked')).map(e => e.value);
                const acomps = Array.from(document.querySelectorAll('input[name="acomp"]:checked')).map(e => e.value);

                if (prots.length === 0) return alert("Escolha a prote√≠na!");
                precoFinal = parseFloat(tam.dataset.preco);
                detalhes = `TAM: ${tam.value}`;
                if (bases.length) detalhes += ` | BASE: ${bases.join(", ")}`;
                detalhes += ` | PROT: ${prots.join(", ")}`;
                if (acomps.length) detalhes += ` | ACOMP: ${acomps.join(", ")}`;
            }

            carrinho.push({ ...itemAtual, qtd: qtdAtual, total: itemAtual.tipo === "peso" ? precoCalculadoPeso : precoFinal * qtdAtual, detalhes, obs: document.getElementById('modal-obs').value });
            atualizarResumo(); fecharModal();
        }

        function atualizarResumo() {
            const container = document.getElementById('lista-carrinho');
            let totalGeral = 0; container.innerHTML = "";
            carrinho.forEach((i, index) => {
                totalGeral += i.total;
                container.innerHTML += `<div class="resumo-item">
                    <button class="btn-remove" onclick="removerItem(${index})">√ó</button>
                    <strong>${i.tipo === 'peso' ? '' : i.qtd + 'x'} ${i.nome}</strong><br>
                    <small>${i.detalhes}</small>${i.obs ? `<br><small>Obs: ${i.obs}</small>` : ''}
                    <div style="text-align:right; font-weight:bold; color: var(--primary);">R$ ${i.total.toFixed(2)}</div>
                </div>`;
            });
            document.getElementById('total-valor').innerText = `Total: R$ ${totalGeral.toFixed(2)}`;
            document.getElementById('btn-resumo').innerText = `VER CARRINHO (${carrinho.length})`;
        }

        function removerItem(index) { carrinho.splice(index, 1); atualizarResumo(); }

        function enviarWhatsApp() {
            const nome = document.getElementById('cliente-nome').value;
            const local = document.getElementById('cliente-local').value;
            const enderecoLoja = "R. Vinte e Um de Abril, 185 - Centro, Campos dos Goytacazes - RJ";

            if (!nome || !local || !carrinho.length) return alert("Preencha os dados e adicione itens!");

            // Criando link do Maps
            const googleMapsLink = `https://www.google.com/maps/dir/${encodeURIComponent(enderecoLoja)}/${encodeURIComponent(local)}`;

            let msg = `*NOVO PEDIDO - SABOR IDEAL*\n--------------------------\nüë§ *Cliente:* ${nome}\nüìç *Endere√ßo:* ${local}\nüí≥ *Pagamento:* ${document.getElementById('pagamento').value}\n--------------------------\n\n`;

            carrinho.forEach(i => {
                msg += `‚úÖ *${i.tipo === 'peso' ? '' : i.qtd + 'x'} ${i.nome}*\n   ${i.detalhes}\n${i.obs ? `   Obs: ${i.obs}\n` : ''}   Subtotal: R$ ${i.total.toFixed(2)}\n\n`;
            });

            msg += `--------------------------\n*TOTAL: ${document.getElementById('total-valor').innerText}*\n`;
            msg += `üó∫Ô∏è *Ver Rota Entrega:* ${googleMapsLink}`;

            window.open(`https://wa.me/5522988302170?text=${encodeURIComponent(msg)}`, '_blank');

            // LIMPEZA AP√ìS O ENVIO
            setTimeout(() => {
                carrinho = [];
                document.getElementById('cliente-nome').value = "";
                document.getElementById('cliente-local').value = "";
                atualizarResumo();
                irPara('tela-inicio');
                alert("Pedido enviado com sucesso!");
            }, 1000);
        }

        function irPara(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            if (id === 'tela-inicio') document.getElementById('step-1').classList.add('active');
            else if (id === 'tela-lanches') document.getElementById('step-2').classList.add('active');
            else document.getElementById('step-3').classList.add('active');
        }

        function fecharModal() { document.getElementById('modal-qty').classList.add('hidden'); }
        function alterarQtd(v) { qtdAtual = Math.max(1, qtdAtual + v); document.getElementById('qtd-display').innerText = qtdAtual; }
    </script>
</body>

</html>